$(function(){if(cccx_yt=="1"){$('#xmchengxiao_fm').form('load','/xiangmuguanli/load_cccx?xmid='+xmid+'&shijian='+sf)};$("#jxcc_dg").datagrid({singleSelect:true,async:false,collapsible:true,method:'post',url:'/xiangmuguanli/getxmjx_cc',toolbar:'#jxcc_toolbar',rownumbers:true,pagination:true,nowrap:false,autoRowheight:false,queryParams:{xmglid:xmid}});$("#jxxl_dg").datagrid({singleSelect:true,async:false,collapsible:true,method:'post',url:'/xiangmuguanli/getxmjx_xl',toolbar:'#jxxl_toolbar',rownumbers:true,pagination:true,autoRowheight:false,nowrap:false,queryParams:{xmglid:xmid}});var p=$('#jxxl_dg').datagrid('getPager');$(p).pagination({pageSize:10,pageList:[5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100],beforePageText:'第',afterPageText:'页    共 {pages} 页',displayMsg:'当前显示 {from} - {to} 条记录   共 {total} 条记录',});var p1=$('#jxcc_dg').datagrid('getPager');$(p1).pagination({pageSize:10,pageList:[5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100],beforePageText:'第',afterPageText:'页    共 {pages} 页',displayMsg:'当前显示 {from} - {to} 条记录   共 {total} 条记录',});$('#xmchanchu').textbox().textbox('addClearBtn','icon-clear');$('#xmchengxiao').textbox().textbox('addClearBtn','icon-clear');$('#cc_zhibiao').textbox().textbox('addClearBtn','icon-clear');$('#cc_mubiao').textbox().textbox('addClearBtn','icon-clear');$('#cc_you').textbox().textbox('addClearBtn','icon-clear');$('#cc_liang').textbox().textbox('addClearBtn','icon-clear');$('#cc_zhong').textbox().textbox('addClearBtn','icon-clear');$('#cc_cha').textbox().textbox('addClearBtn','icon-clear');$('#xl_zhibiao').textbox().textbox('addClearBtn','icon-clear');$('#xl_mubiao').textbox().textbox('addClearBtn','icon-clear');$('#xl_you').textbox().textbox('addClearBtn','icon-clear');$('#xl_liang').textbox().textbox('addClearBtn','icon-clear');$('#xl_zhong').textbox().textbox('addClearBtn','icon-clear');$('#xl_cha').textbox().textbox('addClearBtn','icon-clear')});$.extend($.fn.textbox.methods,{addClearBtn:function(jq,iconCls){return jq.each(function(){var t=$(this);var opts=t.textbox('options');opts.icons=opts.icons||[];opts.icons.unshift({iconCls:iconCls,handler:function(e){$(e.data.target).textbox('clear').textbox('textbox').focus();$(this).css('visibility','hidden')}});t.textbox();if(!t.textbox('getText')){t.textbox('getIcon',0).css('visibility','hidden')}t.textbox('textbox').bind('keyup',function(){var icon=t.textbox('getIcon',0);if($(this).val()){icon.css('visibility','visible')}else{icon.css('visibility','hidden')}})})}});var url;function add_cccx(){if(cccx_yt=="1"){url='/xiangmuguanli/edit_cccx?name='+xmname+'&xmid='+xmid}else{url='/xiangmuguanli/add_cccx?name='+xmname+'&xmid='+xmid}$('#xmchengxiao_fm').form('submit',{url:url,success:function(result){result=JSON.parse(result);if(result.success){$.messager.show({title:'提示',msg:result.message});$('#addcccx').linkbutton({text:'更新'});cccx_yt="1"}else{$.messager.show({title:'错误提示',msg:result.errorMsg})}}})};function jxcc_new(){$('#jxcc_dlg').dialog('open').dialog('setTitle','新增绩效产出指标');$('#jxcc_fm').form('clear');url='/xiangmuguanli/jxcc_save?xmglID='+xmid};function jxcc_edit(){var row=$('#jxcc_dg').datagrid('getSelected');if(row){$('#jxcc_dlg').dialog('open').dialog('setTitle','编辑项目');$('#jxcc_fm').form('load',row);var xmjxccID=row.xmjixiao_ccID;url='/xiangmuguanli/jxcc_edit?xmjxccID='+xmjxccID}else{$.messager.alert("错误提示","请选择要编辑的行！","warning")}};function jxcc_destroy(){var row=$('#jxcc_dg').datagrid('getSelected');if(row){$.messager.confirm('提示','您确定要删除这条记录吗？',function(r){if(r){$.post('/xiangmuguanli/jxcc_del',{id:row.xmjixiao_ccID,xmglID:xmid},function(result){if(result.success){$('#jxcc_dg').datagrid('reload');}else{result=JSON.parse(result);$.messager.show({title:'错误提示',msg:result.errorMsg})}},'json')}})}else{$.messager.alert("错误提示","请选择要删除的行！","warning")}};function jxcc_save(){$('#jxcc_fm').form('submit',{url:url,onSubmit:function(){return $(this).form('validate')},success:function(result){result=JSON.parse(result);$('#jxcc_dlg').dialog('close');$('#jxcc_dg').datagrid('reload');if(result.success==true){$.messager.show({title:'提示',msg:result.message})}if(result.success==false){$.messager.show({title:'错误提示',msg:result.errorMsg})}}})};function jxxl_new(){$('#jxxl_dlg').dialog('open').dialog('setTitle','新增绩效效率指标');$('#jxxl_fm').form('clear');url='/xiangmuguanli/jxxl_save?xmglID='+xmid};function jxxl_edit(){var row=$('#jxxl_dg').datagrid('getSelected');if(row){$('#jxxl_dlg').dialog('open').dialog('setTitle','编辑项目');$('#jxxl_fm').form('load',row);var xmjixiao_xlID=row.xmjixiao_xlID;url='/xiangmuguanli/jxxl_edit?xmjixiao_xlID='+xmjixiao_xlID}else{$.messager.alert("错误提示","请选择要编辑的行！","warning")}};function jxxl_save(){$('#jxxl_fm').form('submit',{url:url,onSubmit:function(){return $(this).form('validate')},success:function(result){result=JSON.parse(result);$('#jxxl_dlg').dialog('close');$('#jxxl_dg').datagrid('reload');if(result.success==true){$.messager.show({title:'提示',msg:result.message})}if(result.success==false){$.messager.show({title:'错误提示',msg:result.errorMsg})}}})};function jxxl_destroy(){var row=$('#jxxl_dg').datagrid('getSelected');if(row){$.messager.confirm('提示','您确定要删除这条记录吗？',function(r){if(r){$.post('/xiangmuguanli/jxxl_del',{id:row.xmjixiao_xlID,xmglID:xmid},function(result){if(result.success){$('#jxxl_dg').datagrid('reload');}else{result=JSON.parse(result);$.messager.show({title:'错误提示',msg:result.errorMsg})}},'json')}})}else{$.messager.alert("错误提示","请选择要删除的行！","warning")}};