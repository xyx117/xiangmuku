$(function () { $("#cwkz_dg").datagrid({ singleSelect: false, selectOnCheck: true, checkOnSelect: true, async: false, collapsible: true, method: "post", url: "/Account/ywzygetuser_yg", toolbar: "#cwkz_toolbar", rownumbers: true, pagination: true, fitcolumns: true, nowrap: true, fit: true, autoRowHeight: false, queryParams: { searchquery: "" }, }); var p = $("#cwkz_dg").datagrid("getPager"); $(p).pagination({ pageSize: 10, pageList: [5, 10, 15, 20, 25, 30, 35, 40, 45, 50], beforePageText: "第", afterPageText: "页    共 {pages} 页", displayMsg: "当前显示 {from} - {to} 条记录   共 {total} 条记录", }) }); function doSearch(value) { $("#cwkz_dg").datagrid("load", { "searchquery": value }) } function newUser() { $("#cwkz_dlg").dialog("open").dialog("setTitle", "新增用户"); $("#name").textbox("enable", "true"); $("#juese").show(); $("#bumen").show(); $("#pw").show(); $("#pw_cf").show(); $("#imf").show(); $("#cwkz_fm").form("clear"); url = "/Account/ywzysaveuser" } function init_pw() { var rows = $("#cwkz_dg").datagrid("getChecked"); var users = []; if (rows) { $("#restpaw_dlg").dialog("open").dialog("setTitle", "重置密码"); $.each(rows, function (index, item) { users.push(item.Id) }); url = "/Account/Ywzy_init_pw?users=" + users } else { $.messager.alert("错误提示", "请选择要重置密码的用户！", "warning") } } function init_pw_conf() { $("#restpaw_fm").form("submit", { url: url, onSubmit: function () { return $(this).form("validate") }, success: function (result) { result = JSON.parse(result); $("#restpaw_dlg").dialog("close"); $("#cwkz_dg").datagrid("reload"); if (result.success == true) { $.messager.show({ title: "提示", msg: result.errorMsg }) } else { $.messager.show({ title: "错误提示", msg: result.errorMsg }) } } }) };